<script src="https://momentjs.com/downloads/moment.min.js"></script>
<script src="https://cdn.datatables.net/1.10.18/js/jquery.dataTables.min.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.18/css/jquery.dataTables.min.css">

  <h1>Incident response priorities for IT services</h1>

  {{#if error}}
  <div aria-live="polite" role="alert" class="alert alert-danger">
    <p><strong>Opps this is not suppose to happen...</strong></p>
    <p>{{error}}</p>
  </div>
  {{else}}

  <div class="lead">
    <p>These are the services, web and apis developed by KTH´s IT-department.</p>
  </div>

   <a name="irt"></a>
  <p>
    The coloured circles indicates how fast the Operations or Support team start working on the service incase of an outage.
    You can see each service classification bellow.

  <div class="row">
    <div class="col-sm">
      <span class="importance high"></span> <strong>High</strong> <span class="alert-info-text">- Actively monitored by operations
        personal during office hours. Operations are on call until midnight. Action to bring back the service is
        normally taken <strong>within 15 minutes during office hours</strong>, and within one hour during On call hours.</span><br /><br />
    </div>
    <div class="col-sm">
      <span class="importance medium"></span> <strong>Medium</strong> <span class="alert-info-text">- Actively monitored by operations
        personal during office hours. Action to bring back the service is normally <strong>within 2 hours</strong>. Outages outside
        office hours are handled the following morning.</span><br /><br />
    </div>
    <div class="col-sm">
      <span class="importance low"></span> <strong>Low</strong> <span class="alert-info-text">- The service is normally back <strong>within a
        day</strong>.</span><br /><br />
    </div>
    
  </div>

  <table id="deployments">

    <thead>
      <tr>
        <th>Application</th>
        <th>Url</th>
        <th>Deployed</th>
        <th>Responsible team: </th>
      </tr>
    </thead>

    <tbody>

      {{#each data}}
      <tr>
        <td class="applicationName"><a href="#irt"><span title="Incident Response Priority: {{this.importance}}" class="importance {{this.importance}}"></span></a>
          <a href="#{{this.applicationName}}">{{this.friendlyName}}</a>
        </td>
        <td class="path"><a href="{{this.applicationUrl}}">{{this.applicationUrl}}</a></td>
        <td class="created"><span style="display: none">{{this.created}}</span><span id="created{{@index}}">{{this.created}}</span></td>
        <td class="team">{{this.team}}</td>
      </tr>
      <script>

        document.getElementById("created{{@index}}").innerHTML = moment.unix({{ this.created }}).fromNow()

      </script>

      {{/each}}

    </tbody>
  </table>
  <p>Applications deployed: <i>{{data.length}}</i></p>

<div aria-live="polite" role="alert" class="alert alert-info">
  <h2>Is something not working?</h2>

  <p>Have a look at our list of our <a href="https://www.kthstatus.se/">services status
      here</a> to see if they are working as intended. For more information about larger outages, please see the
      <a href="https://www.kth.se/en/gemensamt/driftsinformation-webbtjanster/ug-rss">IT-Support pages</a>.
  </p>
</div>

  {{#each data}}
  <a name="{{this.applicationName}}"></a>
  <div class="application">
    
    {{#if this.publicNameEnglish}}
      <h3>{{this.publicNameEnglish}} <span class="applicationName"> - {{this.applicationName}}</span></h3>
    {{else}}
      <h3>{{this.applicationName}}</h3>
    {{/if}}

    {{#if this.applicationUrl}}
      <div class="applicationUrl"><a href="{{this.applicationUrl}}">{{this.applicationUrl}}</a></div>
    {{/if}}
    
<div class="row">
    <div class="col-sm">
      {{#if this.descriptionEnglish }}
        <img src="https://app.kth.se/style/kth-style/img/kth-style/icons/en_UK.svg" />
        {{this.descriptionEnglish}}
      {{/if}}
    </div>
    <div class="col-sm">

      {{#if this.descriptionSwedish }}
        <img src="https://app.kth.se/style/kth-style/img/kth-style/icons/sv_SE.svg" />
        {{this.descriptionSwedish}}
      {{/if}}
    </div>
  </div>

  {{#if this.publicUserDocumentationUrl}}
        {{#if this.publicApiDocumentationUrl}}
          <div class="publicApiDocumentationUrl"><a href="{{this.publicApiDocumentationUrl}}">API documentation</a></div>
        {{else}}
          <div class="publicUserDocumentationUrl"><a href="{{this.publicUserDocumentationUrl}}">User documentation</a></div>
        {{/if}}
  {{/if}}

    <ul>
    
      <li><strong class="updated">Last updated:</strong> <span id="updated{{this.applicationName}}">{{this.created}}</span>
      <script>
        document.getElementById("updated{{this.applicationName}}").innerHTML = moment.unix({{ this.created }}).fromNow()
      </script></li>
      
    {{#if this.publicNameSwedish}}
      <li><strong>Svenskt namn:</strong> {{this.publicNameSwedish}}</li>
    {{/if}}


    {{#if this.aboutUrl}}
       <li><strong>About page:</strong> <a href="{{this.aboutUrl}}">{{this.aboutUrl}}</a></li>
    {{/if}}

    {{#if this.applicationUrl}}
       <li><strong>Monitor page:</strong> <a href="{{this.monitorUrl}}">{{this.monitorUrl}}</a> that should contain <strong>{{this.monitorPattern}}</strong> to be marked as up.</li>
    {{/if}}
    
    <li><strong>Version: </strong>{{this.version}}</li>

    {{#if this.importance}}
      <li><strong>Incident response priority:</strong> <span title="Application importance: {{this.importance}}" class="importance {{this.importance}}"></span>
      {{this.importance}}</li>
    {{/if}}
    
    {{#if this.team}}
      <li><strong>Responsible team: </strong>{{this.team}}</li></li>
    {{/if}}

    {{#if this.cluster}}
      <li><strong>Running in: </strong>{{this.cluster}}</li></li>
    {{/if}}

    </ul>
    <hr />
  </div>
  {{/each}} {{/if}}


  <script>
    $(function () {
      if ($(window).width() > 768) {
        $('#deployments').DataTable({
          paging: false,
          info: false,
          searching: false,
          order: [[2, 'desc']],
          columnDefs: []
        })
      }
    })
  </script>

<p>Read more about <a href="https://www.kth.se/it/tjansteutbud/beredskap-1.681065"> KTH´s on call policy (In
        Swedish)</a>.</p>
